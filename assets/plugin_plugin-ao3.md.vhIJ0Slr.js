import{_ as s,c as i,o as a,R as n}from"./chunks/framework.ZUvglspe.js";const c=JSON.parse('{"title":"plugin-ao3","description":"","frontmatter":{},"headers":[],"relativePath":"plugin/plugin-ao3.md","filePath":"plugin/plugin-ao3.md"}'),l={name:"plugin/plugin-ao3.md"},t=n(`<h1 id="plugin-ao3" tabindex="-1">plugin-ao3 <a class="header-anchor" href="#plugin-ao3" aria-label="Permalink to &quot;plugin-ao3&quot;">​</a></h1><p>从 <a href="https://archiveofourown.org/" target="_blank" rel="noreferrer">ao3</a> 下载小说，或者将小说发布到 ao3。</p><h2 id="input" tabindex="-1">input <a class="header-anchor" href="#input" aria-label="Permalink to &quot;input&quot;">​</a></h2><p>可以配合其他插件将之转换为其他格式，例如 epub。</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">tasks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">fetch</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@mark-magic/plugin-ao3&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://forums.sufficientvelocity.com/threads/puella-magi-adfligo-systema.2538/</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        site</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">sufficientvelocity</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        cached</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    output</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@mark-magic/plugin-epub&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">./dist/epub/puella-magi-adfligo-systema.epub</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pmas</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        title</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Puella Magi Adfligo Systema</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        creator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Firnagzen</span></span></code></pre></div><p>幸运的是，已经基于这个插件实现了 <a href="https://epubhub.rxliuli.com/" target="_blank" rel="noreferrer">epubhub</a>，用以从同人小说网站下载 epub，不需要使用更底层的 mark-magic 命令行工具。</p><h3 id="url" tabindex="-1">url <a class="header-anchor" href="#url" aria-label="Permalink to &quot;url&quot;">​</a></h3><p>下载小说的地址，会自动识别其中的书籍 id。例如以下链接都会被正确识别</p><ul><li><a href="https://archiveofourown.org/works/777002/chapters/1461984" target="_blank" rel="noreferrer">https://archiveofourown.org/works/777002/chapters/1461984</a></li><li><a href="https://archiveofourown.org/works/777002/" target="_blank" rel="noreferrer">https://archiveofourown.org/works/777002/</a></li></ul><p>这个插件还支持以下网站作为输入。</p><ul><li><a href="https://forums.sufficientvelocity.com" target="_blank" rel="noreferrer">https://forums.sufficientvelocity.com</a></li><li><a href="https://forums.spacebattles.com/" target="_blank" rel="noreferrer">https://forums.spacebattles.com/</a></li><li><a href="https://www.bilibili.com/read/home" target="_blank" rel="noreferrer">https://www.bilibili.com/read/home</a></li></ul><h2 id="output" tabindex="-1">output <a class="header-anchor" href="#output" aria-label="Permalink to &quot;output&quot;">​</a></h2><p>将 markdown 小说发布到其他地方，或者结合输入同步 sv/sb 论坛上的小说到 ao3 上。</p><p>例如 pmas 中文翻译发布到 ao3 的配置如下，参考: <a href="https://github.com/liuli-moe/pmas/blob/main/mark-magic.config.yaml#L54-L66" target="_blank" rel="noreferrer">https://github.com/liuli-moe/pmas/blob/main/mark-magic.config.yaml#L54-L66</a></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">tasks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">publishToAo3</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@mark-magic/plugin-local&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">./books/zh-CN</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        ignore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;999.md&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;12*.md&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    output</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@mark-magic/plugin-ao3&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;53445904&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        cookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\${AO3_COOKIE}</span></span></code></pre></div><h3 id="id" tabindex="-1">id <a class="header-anchor" href="#id" aria-label="Permalink to &quot;id&quot;">​</a></h3><p>需要同步的书籍 id。例如 <a href="https://archiveofourown.org/works/777002/" target="_blank" rel="noreferrer">https://archiveofourown.org/works/777002/</a> 的书籍 id 是 777002。</p><h3 id="cookie" tabindex="-1">cookie <a class="header-anchor" href="#cookie" aria-label="Permalink to &quot;cookie&quot;">​</a></h3><p>登录 ao3 账户之后的认证信息，可以在浏览器的开发者工具中复制 cookie。</p><blockquote><p><strong>⚠️ 注意：请不要将 cookie 发送给其他人或发布到网络上，有了它就相当于有了账户密码！</strong> 如果要同步配置文件，应该使用 <a href="./../config.html#环境变量">环境变量</a> 引用机密信息。</p></blockquote><p>具体步骤</p><ol><li><p>登录 ao3 网站</p></li><li><p>从菜单 <strong>More Tool &gt; Developer Tools</strong> 打开开发者控制台，或者使用 <code>Command+Option+I(Mac)/Ctrl+Shift+I(Windows)</code></p></li><li><p>切换到 <strong>Network</strong> 选项卡</p></li><li><p>刷新网页</p></li><li><p>找到第一个请求，右键选择 <strong>Copy &gt; Copy as cURL</strong></p></li><li><p>从 cURL 中找到 cookie，下面这个简化的 curl 命令中的 cookie 就是 <code>view_adult=true; user_credentials=1; ********67f</code></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;https://archiveofourown.org/works/777002/chapters/1461984&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;cookie: view_adult=true; user_credentials=1; ********67f&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> --compressed</span></span></code></pre></div></li></ol>`,22),p=[t];function e(h,k,r,o,E,d){return a(),i("div",null,p)}const u=s(l,[["render",e]]);export{c as __pageData,u as default};
